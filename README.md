# ホジョリンク
<img width="340" height="340" alt="Image" src="https://github.com/user-attachments/assets/22538546-1797-4723-8379-06d9e5d0d0ca" />

## 製品概要
・ホジョリンク

### 背景(製品開発のきっかけ、課題等）)
現在、AIの普及により、プログラミング学習などのデジタル教育の需要が増加しています。特にオンラインプログラミング教室では、講師が直面する深刻な課題があります。​
### (実体験から見えた課題)
オンラインでプログラミング教室の講師を務める中で、教える際に一つの画面に生徒がコーディングしている画面・テキスト教材・生徒のカメラ映像が表示されると、どうしてもソースコードの確認に集中してしまい、生徒の集中が切れていることに気づけないケースが頻発していました。生徒の小さなカメラ映像では、表情の変化や目線の動き、姿勢の崩れといった「集中力低下のサイン」を見逃してしまうのです。​

さらに、複数の生徒を同時に教える場合、この問題はより深刻になります。各生徒のコード進捗を確認しながら、全員の学習態度を把握することは物理的に困難であり、結果として一部の生徒が授業についていけなくなったり、集中力を失ったまま時間が過ぎてしまうという事態が発生していました。​

これらの経験から、講師が教材やコードに集中しながらも、生徒の集中状態を客観的に把握できる補助ツールの必要性を強く感じ、本製品の開発に至りました。

### 製品説明（具体的な製品の説明）
・本製品は教えられる学生の集中力を目の開き具合やカメラからの顔の移り方などを通じてスコアとして評価を行い、スコアが高いと「集中している」、スコアが低いと「集中していない」と表示されます。この表示と同時に「集中中」もしくは「非集中中」のタイマーも動作します。非集中中のタイマーは一定期間増えていくと集中してくださいという通知も表示されます。

### 特長
#### 1. リアルタイム集中度モニタリング<br>
MediaPipeを活用した顔認識技術により、目の開き具合や顔の向きをリアルタイムで解析し、学生の集中状態を数値化して表示します。<br>
#### 2. 自動時間管理システム<br>
集中している時間と集中していない時間を自動的に計測し、学習効率の可視化を実現。一定時間非集中状態が続くと自動的に通知を表示します。
#### 3. シンプルで直感的なUI<br>
Webカメラのみで動作し、複雑な設定不要。学生と講師の両方が簡単に集中度を確認できるインターフェースを提供します。

### 解決出来ること<br>
・オンライン授業における学生の集中状態の可視化<br>
・講師が複数の学生を同時に見守る際の補助<br>
・学生自身による学習状態の自己管理と改善<br>
・非集中状態の早期検知による学習効率の向上<br>
### 今後の展望<br>
**1.データベースの高度化による教師・生徒間の連携強化**<br>
現在実装しているsqlite3データベースをさらに拡張し、教師と生徒のアカウント管理システムを構築します。より高度なデータベース連携を実装することで、各生徒の学習履歴や集中度データを長期的に蓄積・分析できるようにし、個別最適化された学習支援を実現します。これにより、教師は生徒ごとの集中パターンや学習傾向を把握し、より効果的な指導計画を立てることが可能になります。<br>

**2.双方向コミュニケーション機能の追加**<br>
教師から生徒へのメッセージ送信機能を実装し、集中力が低下している生徒に対して個別に声かけや励ましのメッセージを送れるようにします。さらに、生徒から教師への質問機能や、理解度を示すリアクション機能も追加することで、オンライン授業でもよりインタラクティブなコミュニケーションを実現します。<br>

**3.既存学習プラットフォームとの連携**<br>
将来的には、ZoomやGoogle Classroomなどの既存オンライン教育プラットフォームとのAPI連携を目指し、教育データの一元管理を実現します。学習eポータルとしての機能も持たせることで、より広範な教育エコシステムの一部として機能させることを検討しています。<br>

**4.処理の最適化**<br>
今回は、同期処理をするFlaskを利用したため、顔認識処理を開始するとページの表示ができない問題が出ました。<br>
そのため、JavaScriptからPythonに連続して画像をリクエストし、ページの表示と顔認識処理を両立させたが、無駄な通信が多いと感じました。<br>
今後は非同期処理が可能なFastAPIを利用しカメラの処理もPython側ですることで無駄な通信をなくし、webアプリケーションの負荷軽減に努めたいです。<br>

### 注力したこと（こだわり等）
**こだわりポイント1**<br>
顔認識の精度向上と処理速度の最適化。MediaPipeの特徴点検出を活用し、目の開閉状態や顔の向きを正確に判定できるアルゴリズムを独自開発しました。リアルタイム処理でも動作が重くならないよう、データ処理の効率化にも注力しました。<br>

**こだわりポイント２**<br>
ユーザー体験の向上。集中度スコアの表示方法やタイマーのUIを何度も改良し、学生が自然に学習に集中できるデザインを目指しました。また、通知のタイミングや表示方法を調整し、学習の妨げにならないよう配慮しています。<br>


## 開発技術

### 活用した技術
- HTML
- CSS
- JavaScript
- Python

#### API・データ

**独自開発REST API**

本製品では、Flaskを用いて以下のRESTful APIエンドポイントを設計・実装

**認証・アカウント管理API**
- `POST /` - ユーザーログイン処理（生徒/教師の認証）
- `POST /signup` - 新規ユーザー登録（生徒または教師として登録）
- `GET /logout` - ログアウト処理

**生徒用API**
- `POST /index_coolver` - リアルタイム集中度判定API（Base64エンコードされた画像データを受信し、MediaPipeで顔認識処理を実行、集中度スコアを返却）
- `POST /api/start-session` - 学習セッション開始（教師名、開始時刻を記録）
- `POST /api/end-session` - 学習セッション終了（集中時間・非集中時間、タグ、メモを保存）

**教師用API**
- `GET /index_teacher` - 教師ダッシュボード画面
- `GET /api/teacher/students` - 全生徒の現在のログイン状態と集中度情報を取得（リアルタイムモニタリング用）
- `GET /api/teacher/student-history/<student_id>` - 指定した生徒の過去の学習履歴を取得（最大10件）
- `POST /api/teacher/send-message` - 生徒へのメッセージ送信API（将来的な双方向通信機能の基盤）

**MediaPipe Face Mesh API**

GoogleのMediaPipe Face Mesh APIを活用し、顔の特徴点468点をリアルタイムで検出します。特に目の開閉状態を判定するEAR（Eye Aspect Ratio）アルゴリズムを実装し、6つの特徴点（左目：33, 160, 158, 133, 153, 144）から目の縦横比を計算して集中度スコアを算出しています。BlazeFaceベースの軽量モデルにより、モバイルデバイスでも高速動作を実現しています。

#### フレームワーク・ライブラリ・モジュール

**バックエンド**
- **Flask** - PythonベースのWebアプリケーションフレームワーク。RESTful API設計に最適化された軽量フレームワークとして採用
- **sqlite3** - 軽量データベースエンジン。ユーザー情報（TEST.db）と生徒個別の学習履歴（各生徒名.db）を管理
- **cv2 (OpenCV)** - 画像処理ライブラリ。カメラ映像の取得とBase64デコード処理を担当
- **mediapipe** - Google開発の機械学習ライブラリ。顔認識とランドマーク検出に使用
- **numpy** - 数値計算ライブラリ。EAR計算やランドマーク座標処理に使用
- **base64** - 画像データのエンコード/デコード処理
- **secrets** - セッションキー生成用の暗号学的に安全な乱数生成モジュール
- **time** - タイマー機能と時間計測
- **datetime** - 日時管理（学習セッションの開始/終了時刻記録）

**セッション管理**
- Flaskのセッション機能とSQLite3を組み合わせ、ユーザー認証状態とアクティブセッション情報を管理

#### デバイス
- PC
- Webカメラ

### 独自技術
#### ハッカソンで開発した独自機能・技術

**顔特徴点ベースの集中度判定アルゴリズム**<br>
- MediaPipe Face Meshの468点のランドマーク情報から、特に目の周辺6点を抽出し、EAR（Eye Aspect Ratio）を独自に計算する集中度スコアリングシステムを開発しました。目が閉じている時間、顔がカメラから外れている時間を累積計測し、リアルタイムで0〜100のスコアに変換します。<br>

**リアルタイム時間管理システム**<br>
- カメラから取得したスコア情報をもとに、「集中中」「非集中中」の2つのタイマーを並行動作させるアルゴリズムを実装しました。非集中状態が一定時間継続すると自動的に通知を表示する機能も搭載しています。<br>

**Base64画像ストリーミング処理**<br>
- フロントエンドから送信されるBase64エンコード画像をデコードし、OpenCVとMediaPipeで処理してJSON形式で集中状態を返却する非同期処理パイプラインを構築しました。<br>

**マルチユーザー学習履歴管理システム**<br>
- 各生徒ごとに個別のSQLiteデータベース（`{username}.db`）を自動生成し、学習セッションごとに教師名・開始時刻・終了時刻・集中時間・非集中時間・タグ・メモを記録する独自のデータ管理システムを開発しました。教師は複数の生徒の学習状況を一元管理できます。<br>

**教師・生徒間リアルタイム連携基盤**<br>
- RESTful API設計により、教師側から全生徒のログイン状態と現在の集中度をリアルタイムで取得できるポーリング型モニタリングシステムを実装しました。将来的なWebSocket統合に対応できる拡張可能な設計になっています。<br>
