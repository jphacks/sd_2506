<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈõÜ‰∏≠Âäõ„É¢„Éã„Çø„É™„É≥„Ç∞ - Cool Version</title>
    
    <!-- Bootstrap 5.3 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_coolver.css')}}">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest_coolver.json">
    <meta name="theme-color" content="#6366f1">
</head>
<body>
    <div class="container-fluid">
        <div class="main-card p-4">
            
            <!-- „É°„Ç§„É≥ÁîªÈù¢ -->
            <div id="main-screen" class="screen">
                <div class="row g-4">
                    
                    <!-- Â∑¶„Çµ„Ç§„Éâ„Éê„Éº -->
                    <div class="col-lg-3">
                        
                        <!-- ÊàêÈï∑Ë°®Á§∫ -->
                        <div class="section-card mb-3">
                            <h3 class="section-title">
                                <i class="fas fa-seedling"></i>
                                ÊàêÈï∑
                            </h3>
                            <div id="growth-area" class="growth-display">
                                <div class="growth-icon">üå±</div>
                                <div class="growth-level">„É¨„Éô„É´ 0</div>
                            </div>
                        </div>
                        
                        <!-- „É°„Éã„É•„Éº -->
                        <div class="section-card">
                            <h3 class="section-title">
                                <i class="fas fa-bars"></i>
                                „É°„Éã„É•„Éº
                            </h3>
                            <button class="btn-action" id="btn-history">
                                <i class="fas fa-history"></i>
                                <div>Â±•Ê≠¥</div>
                            </button>
                            <button class="btn-action" id="btn-settings">
                                <i class="fas fa-cog"></i>
                                <div>Ë®≠ÂÆö</div>
                            </button>
                        </div>
                        
                    </div>
                    
                    <!-- ‰∏≠Â§Æ„Ç®„É™„Ç¢ -->
                    <div class="col-lg-6">
                        
                        <!-- „Ç´„É°„É©Ë°®Á§∫ -->
                        <div class="camera-container">
                            <video id="camera" autoplay playsinline muted></video>
                            <div class="camera-overlay" id="camera-overlay">
                                <div class="text-center">
                                    <div class="spinner-border text-light mb-3" role="status"></div>
                                    <p id="camera-overlay-text">„Ç´„É°„É©Ëµ∑Âãï‰∏≠...</p>
                                </div>
                            </div>
                            <div class="status-badge status-waiting" id="status-badge">ÂæÖÊ©ü‰∏≠</div>
                        </div>
                        
                        <!-- „Ç´„É°„É©„Ç≥„É≥„Éà„É≠„Éº„É´ -->
                        <div class="text-center mb-3">
                            <button id="camera-toggle" class="btn btn-lg btn-primary-custom">
                                <i class="fas fa-video me-2"></i>„Ç´„É°„É©ON
                            </button>
                        </div>
                        
                        <!-- „É°„Éà„É™„ÇØ„Çπ -->
                        <div class="row g-3 mb-3">
                            <div class="col-4">
                                <div class="metric-box">
                                    <div id="metric-score" class="metric-value">100</div>
                                    <div class="metric-label">„Çπ„Ç≥„Ç¢</div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="metric-box metric-box-success">
                                    <div id="metric-focus-time" class="metric-value">0Áßí</div>
                                    <div class="metric-label">ÈõÜ‰∏≠</div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="metric-box metric-box-warning">
                                    <div id="metric-unfocus-time" class="metric-value">0Áßí</div>
                                    <div class="metric-label">ÈùûÈõÜ‰∏≠</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Áä∂ÊÖãË°®Á§∫ -->
                        <div id="focus-status" class="section-card text-center">
                            <div id="status-icon" class="status-icon-large">‚è≥</div>
                            <div id="status-text" class="status-text">ÂàÜÊûêÂæÖÊ©ü‰∏≠</div>
                            <div id="status-subtext" class="status-subtext">„Ç´„É°„É©„ÇíËµ∑Âãï„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                        </div>
                        
                        <!-- ÈõÜ‰∏≠„ÅåÂàá„Çå„ÅüÊôÇ„ÅÆÊèêÊ°à -->
                        <div id="break-or-game" class="card border-warning d-none mt-3">
                            <div class="card-body text-center">
                                <h6 class="text-warning fw-bold mb-3">
                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                    ÈõÜ‰∏≠„ÅåÂàá„Çå„Å¶„ÅÑ„Åæ„Åô
                                </h6>
                                <p class="text-muted mb-3">„É™„Éï„É¨„ÉÉ„Ç∑„É•„Åó„Åæ„Åõ„Çì„ÅãÔºü</p>
                                <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                                    <button id="manual-game" class="btn btn-orange rounded-pill px-4">
                                        <i class="fas fa-gamepad me-2"></i>Á•ûÁµåË°∞Âº±
                                    </button>
                                    <button id="manual-break" class="btn btn-blue rounded-pill px-4">
                                        <i class="fas fa-coffee me-2"></i>‰ºëÊÜ©
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    
                    <!-- Âè≥„Çµ„Ç§„Éâ„Éê„Éº -->
                    <div class="col-lg-3">
                        
                        <!-- „É™„Éï„É¨„ÉÉ„Ç∑„É• -->
                        <div class="section-card mb-3">
                            <h3 class="section-title">
                                <i class="fas fa-coffee"></i>
                                „É™„Éï„É¨„ÉÉ„Ç∑„É•
                            </h3>
                            <button class="btn-action" id="btn-game">
                                <i class="fas fa-gamepad"></i>
                                <div>Á•ûÁµåË°∞Âº±</div>
                            </button>
                            <button class="btn-action" id="btn-break">
                                <i class="fas fa-clock"></i>
                                <div>‰ºëÊÜ©„Çø„Ç§„Éû„Éº</div>
                            </button>
                        </div>
                        
                        <!-- „Çª„ÉÉ„Ç∑„Éß„É≥Ë®òÈå≤ -->
                        <div class="section-card">
                            <h3 class="section-title">
                                <i class="fas fa-save"></i>
                                Ë®òÈå≤
                            </h3>
                            <div class="mb-3">
                                <label class="form-label fw-bold">„Çø„Ç∞</label>
                                <input type="text" id="input-tags" class="form-control" placeholder="#ÂãâÂº∑, #ÊúùÊ¥ª">
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">„É°„É¢</label>
                                <textarea id="input-memo" class="form-control" rows="3" placeholder="ÊåØ„ÇäËøî„Çä..."></textarea>
                            </div>
                            <button id="save-session" class="btn btn-primary-custom w-100">
                                <i class="fas fa-check me-2"></i>‰øùÂ≠ò
                            </button>
                        </div>
                        
                    </div>
                    
                </div>
            </div>
            
            <!-- Á•ûÁµåË°∞Âº±„Ç≤„Éº„É†ÁîªÈù¢ -->
            <div id="memory-game-screen" class="screen d-none">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-gamepad me-2"></i>Á•ûÁµåË°∞Âº±„Ç≤„Éº„É†</h2>
                    <button id="back-main-from-game" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Êàª„Çã
                    </button>
                </div>
                <div id="memory-game"></div>
            </div>
            
            <!-- ‰ºëÊÜ©„Çø„Ç§„Éû„ÉºÁîªÈù¢ -->
            <div id="break-timer-screen" class="screen d-none">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-clock me-2"></i>‰ºëÊÜ©„Çø„Ç§„Éû„Éº</h2>
                    <button id="back-main-from-break" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Êàª„Çã
                    </button>
                </div>
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="section-card">
                            <div class="mb-3">
                                <label class="form-label fw-bold">‰ºëÊÜ©ÊôÇÈñì</label>
                                <div class="row g-2">
                                    <div class="col-4">
                                        <input type="number" id="break-hour" class="form-control" value="0" min="0" max="2">
                                        <small class="text-muted">ÊôÇ</small>
                                    </div>
                                    <div class="col-4">
                                        <input type="number" id="break-min" class="form-control" value="5" min="0" max="59">
                                        <small class="text-muted">ÂàÜ</small>
                                    </div>
                                    <div class="col-4">
                                        <input type="number" id="break-sec" class="form-control" value="0" min="0" max="59">
                                        <small class="text-muted">Áßí</small>
                                    </div>
                                </div>
                            </div>
                            <button id="start-break-timer" class="btn btn-primary-custom w-100 mb-3">
                                <i class="fas fa-play me-2"></i>‰ºëÊÜ©ÈñãÂßã
                            </button>
                            <div id="break-timer"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Â±•Ê≠¥ÁîªÈù¢ -->
            <div id="history-screen" class="screen d-none">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-history me-2"></i>ÈõÜ‰∏≠Â±•Ê≠¥</h2>
                    <button id="back-main-from-history" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Êàª„Çã
                    </button>
                </div>
                <div class="section-card mb-3">
                    <h4 class="mb-3">
                        <i class="fas fa-robot me-2"></i>AIÂàÜÊûêÁµêÊûú
                    </h4>
                    <div id="ai-feedback" class="alert alert-info">ÂàÜÊûê‰∏≠...</div>
                </div>
                <div class="section-card">
                    <h4 class="mb-3">
                        <i class="fas fa-table me-2"></i>„Çª„ÉÉ„Ç∑„Éß„É≥Â±•Ê≠¥
                    </h4>
                    <div id="history-list"></div>
                </div>
            </div>
            
            <!-- Ë®≠ÂÆöÁîªÈù¢ -->
            <div id="settings-screen" class="screen d-none">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-cog me-2"></i>Ë®≠ÂÆö</h2>
                    <button id="back-main-from-settings" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Êàª„Çã
                    </button>
                </div>
                
                <!-- BGM„Ç¢„É©„Éº„ÉàË°®Á§∫„Ç®„É™„Ç¢ -->
                <div id="bgm-alert-area" class="mb-3"></div>
                
                <!-- ÈÄöÁü•Ë®≠ÂÆö -->
                <div class="section-card mb-3">
                    <h4 class="mb-3">
                        <i class="fas fa-bell me-2"></i>ÈÄöÁü•Ë®≠ÂÆö
                    </h4>
                    <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" id="enable-notify" checked>
                        <label class="form-check-label fw-bold" for="enable-notify">
                            „Éá„Çπ„ÇØ„Éà„ÉÉ„ÉóÈÄöÁü•„ÇíÊúâÂäπ„Å´„Åô„Çã
                        </label>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">ÈÄöÁü•„É°„ÉÉ„Çª„Éº„Ç∏</label>
                        <input id="notify-msg" type="text" class="form-control" 
                               value="ÈõÜ‰∏≠ÊôÇÈñì„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åõ„Çì„ÅãÔºü" maxlength="50">
                    </div>
                    <div id="notification-status"></div>
                </div>
                
                <!-- BGMË®≠ÂÆö -->
                <div class="section-card mb-3">
                    <h4 class="mb-3">
                        <i class="fas fa-music me-2"></i>BGMË®≠ÂÆö
                    </h4>
                    <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" id="enable-bgm">
                        <label class="form-check-label fw-bold" for="enable-bgm">
                            BGM„ÇíÊúâÂäπ„Å´„Åô„Çã
                        </label>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">BGMÈÅ∏Êäû</label>
                        <select id="bgm-select" class="form-select">
                            <option value="none">„Å™„Åó</option>
                            <option value="relax" selected>„É™„É©„ÉÉ„ÇØ„ÇπÈü≥Ê•Ω</option>
                            <option value="cafe">„Ç´„Éï„Çß„ÅÆÈü≥</option>
                            <option value="rain">Èõ®Èü≥</option>
                        </select>
                    </div>
                    <button id="test-bgm" class="btn btn-success w-100">
                        <i class="fas fa-play me-2"></i>BGM„Çí„ÉÜ„Çπ„ÉàÂÜçÁîü
                    </button>
                </div>
                
                <!-- ÈÄöÁü•„ÉÜ„Çπ„Éà -->
                <div class="section-card">
                    <h4 class="mb-3">
                        <i class="fas fa-bell-slash me-2"></i>ÈÄöÁü•Ê©üËÉΩ„ÉÜ„Çπ„Éà
                    </h4>
                    <div class="d-grid gap-2">
                        <button id="request-notification-permission" class="btn btn-primary">
                            <i class="fas fa-bell me-2"></i>ÈÄöÁü•Ë®±ÂèØ„ÇíË¶ÅÊ±Ç
                        </button>
                        <button id="test-basic-notification" class="btn btn-success">
                            <i class="fas fa-comment-dots me-2"></i>Âü∫Êú¨ÈÄöÁü•„ÉÜ„Çπ„Éà
                        </button>
                        <button id="test-sw-notification" class="btn btn-info">
                            <i class="fas fa-satellite-dish me-2"></i>„Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„ÉâÈÄöÁü•„ÉÜ„Çπ„Éà
                        </button>
                        <div class="row g-2">
                            <div class="col-6">
                                <button id="start-periodic-notifications" class="btn btn-warning btn-sm w-100">
                                    <i class="fas fa-play me-1"></i>ÂÆöÊúüÈÄöÁü•ÈñãÂßã
                                </button>
                            </div>
                            <div class="col-6">
                                <button id="stop-periodic-notifications" class="btn btn-secondary btn-sm w-100">
                                    <i class="fas fa-stop me-1"></i>ÂÆöÊúüÈÄöÁü•ÂÅúÊ≠¢
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            
        </div>
    </div>
    
    <!-- Audio Element -->
    <audio id="bgm-audio" loop preload="none"></audio>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Main Script -->
    <script src="{{ url_for('static', filename='javascript/main_coolver.js')}}"></script>
</body>
</html>
